name: "Python Test"

on:
  workflow_call:
    inputs:
      os:
        required: true
        type: string
      python-version:
        required: true
        type: string

jobs:
  test:
    runs-on: ${{ inputs.os }}

    steps:
      - name: "Checkout repository"
        uses: actions/checkout@8f4b7f84864484a7bf31766abe9204da3cbe65b3

      - name: "Setup Python"
        uses: actions/setup-python@7b9ef6fc5a7a74dfb7c0924eb42615d7af1e4de5
        with:
          python-version: "${{ inputs.python-version }}"
          cache: "pip"
          cache-dependency-path: "pyproject.toml"

      - name: "Update packaging tools"
        run: python -m pip install --upgrade pip wheel setuptools build

      - name: "Install dependencies"
        run: python -m pip install --editable .[tests]

      - name: "Run tests"
        run: python -m pytest
